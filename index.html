<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>IPv4 DFA — Animated Final</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <div>
    <h1>IPv4 DFA — Animated Tech Demo</h1>
    <p class="sub">Academic DFA with tech-demo animations (state pulses, arrow travel). Use Step Mode + Next Step to walk through.</p>
  </div>
</header>

<div class="controls">
  <input id="inputStr" type="text" placeholder="Enter IPv4 e.g. 192.168.0.1" value="192.168.0.1">
  <button id="autoBtn" class="primary">Auto Run</button>
  <button id="nextBtn">Next Step</button>
  <button id="resetBtn">Reset</button>
  <label><input id="stepMode" type="checkbox" checked> Step Mode</label>
  <div style="margin-left:auto" class="small">Space = Next, Enter = Auto Run/Stop, R = Reset</div>
</div>

<div class="layout">
  <div class="viz" id="viz">

    <svg id="dfa" viewBox="0 0 820 500" preserveAspectRatio="xMidYMid meet">
      <defs>
        <marker id="arrowhead" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto">
          <path d="M0 0 L10 5 L0 10 z" fill="#475569"></path>
        </marker>
      </defs>

      <!-- Nodes -->
      <g id="q0" class="node" transform="translate(80,240)"><circle r="38"/><text y="6" text-anchor="middle">q₀</text></g>
      <g id="q1" class="node" transform="translate(240,120)"><circle r="38"/><text y="6" text-anchor="middle">q₁</text></g>
      <g id="q2" class="node" transform="translate(400,240)"><circle r="38"/><text y="6" text-anchor="middle">q₂</text></g>
      <g id="q3" class="node" transform="translate(560,120)"><circle r="38"/><text y="6" text-anchor="middle">q₃</text></g>
      <g id="q4" class="node accept" transform="translate(720,240)">
        <ellipse rx="45" ry="32"/>
        <ellipse rx="36" ry="24" fill="none" stroke="#16a34a" stroke-width="2"/>
        <text y="6" text-anchor="middle">q₄</text>
      </g>
      <g id="dead" class="node dead" transform="translate(400,420)">
        <rect x="-46" y="-22" width="92" height="44" rx="8"/>
        <text y="6" text-anchor="middle">Dead</text>
      </g>

      <!-- Arrows -->
      <path id="p_digit_q1" class="arrow" d="M118 220 Q170 180 200 160"></path>
      <text class="arrow-label" x="160" y="172">digit</text>

      <path id="p_dot_1" class="arrow" d="M280 120 Q320 160 340 180"></path>
      <text class="arrow-label" x="310" y="162">'.'</text>

      <path id="p_digit_q3" class="arrow" d="M420 220 Q470 180 500 160"></path>
      <text class="arrow-label" x="460" y="172">digit</text>

      <path id="p_dot_2" class="arrow" d="M560 120 Q600 160 640 180"></path>
      <text class="arrow-label" x="600" y="162">'.'</text>

      <path id="p_invalid_down" class="arrow invalid" d="M400 260 Q400 320 400 360"></path>
      <text class="arrow-label" x="420" y="300">invalid</text>

      <!-- self loops -->
      <path id="loop_q1" class="arrow" d="M240 72 C210 54 270 54 240 72"></path>
      <text class="arrow-label" x="240" y="48">digit</text>

      <path id="loop_q3" class="arrow" d="M560 72 C530 54 590 54 560 72"></path>
      <text class="arrow-label" x="560" y="48">digit</text>

      <!-- dead loop -->
      <path id="loop_dead" class="arrow" d="M440 420 C470 410 470 440 440 430"></path>
      <text class="arrow-label" x="470" y="420">any</text>

      <!-- dashed invalid arrows -->
      <path class="arrow invalid" d="M80 264 Q150 312 260 360"></path>
      <path class="arrow invalid" d="M240 160 Q300 200 360 220"></path>
      <path class="arrow invalid" d="M400 200 Q420 260 360 320"></path>
      <path class="arrow invalid" d="M560 160 Q520 220 440 300"></path>
      <path class="arrow invalid" d="M720 264 Q650 312 540 360"></path>

      <circle id="glow" class="glow" r="6" cx="0" cy="0"></circle>
    </svg>

    <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
      <div class="badge">State: <span id="curState">q₀</span></div>
      <div class="badge">Char: <span id="curChar">-</span></div>
      <div class="badge">Octet: <span id="curOct">1</span></div>
    </div>

  </div>

  <div class="trace" id="trace">
    <div class="hdr">Trace</div>
    <div id="traceLines" role="log" aria-live="polite"></div>
    <div style="margin-top:8px" class="small">Trace shows each char read, octet value building, transitions and final conclusion.</div>
  </div>

</div>

<script src="script.js"></script>
</body>
</html>
